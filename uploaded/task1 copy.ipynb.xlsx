{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "4aec6a6f",
   "metadata": {},
   "source": [
    "<h1>Task 1: Data Aggregation and Analysis"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "4cc9b465",
   "metadata": {},
   "source": [
    "Questions:\n",
    "1. Across locations, how many apples were purchased in cash?\n",
    "2. How much total cash was spent on these apples?\n",
    "3. Across all payment methods, how much money was spent at the Bakershire store location by non-member customers?"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "36c5494b",
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "from pathlib import Path"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "7b5b1807",
   "metadata": {},
   "outputs": [],
   "source": [
    "data_dir = Path(\"data\")\n",
    "csv_path = data_dir / \"supermarket_transactions.xlsx\"\n",
    "df = pd.read_excel(csv_path)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "06f986db",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "application/vnd.microsoft.datawrangler.viewer.v0+json": {
       "columns": [
        {
         "name": "index",
         "rawType": "int64",
         "type": "integer"
        },
        {
         "name": "Unnamed: 0",
         "rawType": "int64",
         "type": "integer"
        },
        {
         "name": "id",
         "rawType": "object",
         "type": "string"
        },
        {
         "name": "timestamp",
         "rawType": "datetime64[ns]",
         "type": "datetime"
        },
        {
         "name": "quantity",
         "rawType": "int64",
         "type": "integer"
        },
        {
         "name": "product_id",
         "rawType": "object",
         "type": "string"
        },
        {
         "name": "product_name",
         "rawType": "object",
         "type": "string"
        },
        {
         "name": "unit_price",
         "rawType": "float64",
         "type": "float"
        },
        {
         "name": "total_amount",
         "rawType": "float64",
         "type": "float"
        },
        {
         "name": "store",
         "rawType": "object",
         "type": "string"
        },
        {
         "name": "payment_method",
         "rawType": "object",
         "type": "string"
        },
        {
         "name": "customer_id",
         "rawType": "object",
         "type": "string"
        },
        {
         "name": "customer_type",
         "rawType": "object",
         "type": "string"
        }
       ],
       "ref": "605efefe-9ac8-49ab-b9d9-dba1f11cb521",
       "rows": [
        [
         "0",
         "0",
         "47d54138-a950-4ec0-9d4a-e637e8dfb290",
         "2022-04-28 09:11:00",
         "10",
         "56b274d1-b2a4-47be-abaf-6c1c7742beb9",
         "wheat",
         "0.39",
         "3.9",
         "South Billyview",
         "cash",
         "c2b9eddd-df8c-446a-ae34-50ad88f28e0a",
         "non-member"
        ],
        [
         "1",
         "1",
         "dea298b1-26ca-4a43-bcef-4050fb74ce1d",
         "2019-12-06 16:21:00",
         "1",
         "56b274d1-b2a4-47be-abaf-6c1c7742beb9",
         "wheat",
         "0.39",
         "0.39",
         "South Edward",
         "contactless",
         "134a3c2c-8ccc-494c-9916-a15ff10a9125",
         "member"
        ],
        [
         "2",
         "2",
         "8dcd78f6-2e68-4fe3-9bb0-afe3bb2c3944",
         "2019-06-22 15:27:00",
         "10",
         "56b274d1-b2a4-47be-abaf-6c1c7742beb9",
         "wheat",
         "0.39",
         "3.9",
         "South Billyview",
         "contactless",
         "a310b698-4e34-4a4a-8c60-e72fad63f9ba",
         "gold"
        ],
        [
         "3",
         "3",
         "261c100c-b121-44b7-bc03-787f396c2061",
         "2020-08-16 18:14:00",
         "8",
         "56b274d1-b2a4-47be-abaf-6c1c7742beb9",
         "wheat",
         "0.39",
         "3.12",
         "South Michaelfurt",
         "credit card",
         "0dfaced3-271c-4da0-80fc-fd3de4328bd5",
         "corporate"
        ],
        [
         "4",
         "4",
         "7d025b4d-caac-40a5-b954-63cd7bd20f92",
         "2019-11-12 15:46:00",
         "1",
         "56b274d1-b2a4-47be-abaf-6c1c7742beb9",
         "wheat",
         "0.39",
         "0.39",
         "Christopherfurt",
         "cash",
         "b05efb3f-c38e-4b86-8366-32e42340a4dc",
         "gold"
        ]
       ],
       "shape": {
        "columns": 12,
        "rows": 5
       }
      },
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Unnamed: 0</th>\n",
       "      <th>id</th>\n",
       "      <th>timestamp</th>\n",
       "      <th>quantity</th>\n",
       "      <th>product_id</th>\n",
       "      <th>product_name</th>\n",
       "      <th>unit_price</th>\n",
       "      <th>total_amount</th>\n",
       "      <th>store</th>\n",
       "      <th>payment_method</th>\n",
       "      <th>customer_id</th>\n",
       "      <th>customer_type</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>47d54138-a950-4ec0-9d4a-e637e8dfb290</td>\n",
       "      <td>2022-04-28 09:11:00</td>\n",
       "      <td>10</td>\n",
       "      <td>56b274d1-b2a4-47be-abaf-6c1c7742beb9</td>\n",
       "      <td>wheat</td>\n",
       "      <td>0.39</td>\n",
       "      <td>3.90</td>\n",
       "      <td>South Billyview</td>\n",
       "      <td>cash</td>\n",
       "      <td>c2b9eddd-df8c-446a-ae34-50ad88f28e0a</td>\n",
       "      <td>non-member</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>dea298b1-26ca-4a43-bcef-4050fb74ce1d</td>\n",
       "      <td>2019-12-06 16:21:00</td>\n",
       "      <td>1</td>\n",
       "      <td>56b274d1-b2a4-47be-abaf-6c1c7742beb9</td>\n",
       "      <td>wheat</td>\n",
       "      <td>0.39</td>\n",
       "      <td>0.39</td>\n",
       "      <td>South Edward</td>\n",
       "      <td>contactless</td>\n",
       "      <td>134a3c2c-8ccc-494c-9916-a15ff10a9125</td>\n",
       "      <td>member</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2</td>\n",
       "      <td>8dcd78f6-2e68-4fe3-9bb0-afe3bb2c3944</td>\n",
       "      <td>2019-06-22 15:27:00</td>\n",
       "      <td>10</td>\n",
       "      <td>56b274d1-b2a4-47be-abaf-6c1c7742beb9</td>\n",
       "      <td>wheat</td>\n",
       "      <td>0.39</td>\n",
       "      <td>3.90</td>\n",
       "      <td>South Billyview</td>\n",
       "      <td>contactless</td>\n",
       "      <td>a310b698-4e34-4a4a-8c60-e72fad63f9ba</td>\n",
       "      <td>gold</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>3</td>\n",
       "      <td>261c100c-b121-44b7-bc03-787f396c2061</td>\n",
       "      <td>2020-08-16 18:14:00</td>\n",
       "      <td>8</td>\n",
       "      <td>56b274d1-b2a4-47be-abaf-6c1c7742beb9</td>\n",
       "      <td>wheat</td>\n",
       "      <td>0.39</td>\n",
       "      <td>3.12</td>\n",
       "      <td>South Michaelfurt</td>\n",
       "      <td>credit card</td>\n",
       "      <td>0dfaced3-271c-4da0-80fc-fd3de4328bd5</td>\n",
       "      <td>corporate</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>4</td>\n",
       "      <td>7d025b4d-caac-40a5-b954-63cd7bd20f92</td>\n",
       "      <td>2019-11-12 15:46:00</td>\n",
       "      <td>1</td>\n",
       "      <td>56b274d1-b2a4-47be-abaf-6c1c7742beb9</td>\n",
       "      <td>wheat</td>\n",
       "      <td>0.39</td>\n",
       "      <td>0.39</td>\n",
       "      <td>Christopherfurt</td>\n",
       "      <td>cash</td>\n",
       "      <td>b05efb3f-c38e-4b86-8366-32e42340a4dc</td>\n",
       "      <td>gold</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   Unnamed: 0                                    id           timestamp  \\\n",
       "0           0  47d54138-a950-4ec0-9d4a-e637e8dfb290 2022-04-28 09:11:00   \n",
       "1           1  dea298b1-26ca-4a43-bcef-4050fb74ce1d 2019-12-06 16:21:00   \n",
       "2           2  8dcd78f6-2e68-4fe3-9bb0-afe3bb2c3944 2019-06-22 15:27:00   \n",
       "3           3  261c100c-b121-44b7-bc03-787f396c2061 2020-08-16 18:14:00   \n",
       "4           4  7d025b4d-caac-40a5-b954-63cd7bd20f92 2019-11-12 15:46:00   \n",
       "\n",
       "   quantity                            product_id product_name  unit_price  \\\n",
       "0        10  56b274d1-b2a4-47be-abaf-6c1c7742beb9        wheat        0.39   \n",
       "1         1  56b274d1-b2a4-47be-abaf-6c1c7742beb9        wheat        0.39   \n",
       "2        10  56b274d1-b2a4-47be-abaf-6c1c7742beb9        wheat        0.39   \n",
       "3         8  56b274d1-b2a4-47be-abaf-6c1c7742beb9        wheat        0.39   \n",
       "4         1  56b274d1-b2a4-47be-abaf-6c1c7742beb9        wheat        0.39   \n",
       "\n",
       "   total_amount              store payment_method  \\\n",
       "0          3.90    South Billyview           cash   \n",
       "1          0.39       South Edward    contactless   \n",
       "2          3.90    South Billyview    contactless   \n",
       "3          3.12  South Michaelfurt    credit card   \n",
       "4          0.39    Christopherfurt           cash   \n",
       "\n",
       "                            customer_id customer_type  \n",
       "0  c2b9eddd-df8c-446a-ae34-50ad88f28e0a    non-member  \n",
       "1  134a3c2c-8ccc-494c-9916-a15ff10a9125        member  \n",
       "2  a310b698-4e34-4a4a-8c60-e72fad63f9ba          gold  \n",
       "3  0dfaced3-271c-4da0-80fc-fd3de4328bd5     corporate  \n",
       "4  b05efb3f-c38e-4b86-8366-32e42340a4dc          gold  "
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "b018b927",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "application/vnd.microsoft.datawrangler.viewer.v0+json": {
       "columns": [
        {
         "name": "index",
         "rawType": "object",
         "type": "string"
        },
        {
         "name": "0",
         "rawType": "object",
         "type": "unknown"
        }
       ],
       "ref": "5bb47c41-2ae5-4374-a715-5dd5b14ccb5c",
       "rows": [
        [
         "Unnamed: 0",
         "int64"
        ],
        [
         "id",
         "object"
        ],
        [
         "timestamp",
         "datetime64[ns]"
        ],
        [
         "quantity",
         "int64"
        ],
        [
         "product_id",
         "object"
        ],
        [
         "product_name",
         "object"
        ],
        [
         "unit_price",
         "float64"
        ],
        [
         "total_amount",
         "float64"
        ],
        [
         "store",
         "object"
        ],
        [
         "payment_method",
         "object"
        ],
        [
         "customer_id",
         "object"
        ],
        [
         "customer_type",
         "object"
        ]
       ],
       "shape": {
        "columns": 1,
        "rows": 12
       }
      },
      "text/plain": [
       "Unnamed: 0                 int64\n",
       "id                        object\n",
       "timestamp         datetime64[ns]\n",
       "quantity                   int64\n",
       "product_id                object\n",
       "product_name              object\n",
       "unit_price               float64\n",
       "total_amount             float64\n",
       "store                     object\n",
       "payment_method            object\n",
       "customer_id               object\n",
       "customer_type             object\n",
       "dtype: object"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.dtypes"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1e83851f",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "np.int64(117)"
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "\"\"\"\n",
    "select sum(quantity)\n",
    "from supermarket_transactions.xlsx\n",
    "where product_name == \"apple\" and payment_method == \"cash\"\n",
    "\"\"\"\n",
    "\n",
    "# Question 1\n",
    "q1 = df[ (df[\"product_name\"] == \"apple\") \n",
    "        & (df[\"payment_method\"] == \"cash\")\n",
    "        ]\n",
    "num = q1[\"quantity\"].sum()\n",
    "num"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "0a03b165",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "np.float64(537.0299999999997)"
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Question 2\n",
    "q1[\"total_amount\"].sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "68694fa2",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "np.float64(2857.5099999999993)"
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Across all payment methods, how much money was spent at the Bakershire store location by non-member customers?\n",
    "q3_fits_criteria = df[ (df[\"store\"] == \"Bakershire\")\n",
    "                        & (df[\"customer_type\"] == \"non-member\")]\n",
    "\n",
    "q3_fits_criteria[\"total_amount\"].sum()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "6a3e36cb",
   "metadata": {},
   "source": [
    "<p>\n",
    "1: 117 <br>\n",
    "2: $537.03 <br>\n",
    "3: $2857.51\n",
    "</p>"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "0f0c8890",
   "metadata": {},
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.13.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
